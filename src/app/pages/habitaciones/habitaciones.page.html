<div class="habitaciones-page py-4">
  <div class="container">
    <div class="habitaciones-wrap">

      <div class="row g-4 justify-content-center">

        <!-- FORM -->
        <div class="col-12 col-lg-4">
          <div class="card srh-card shadow-lg">

            <div class="card-header srh-head d-flex align-items-center justify-content-between">

              <div class="d-flex align-items-center gap-1">
                <span class="srh-ico">üè®</span>
                <strong>Habitaciones</strong>

                <span class="badge rounded-pill">
                  {{ editandoId !== null ? 'Editando' : 'Nuevo' }}
                </span>
              </div>

              <div class="d-flex gap-1 align-items-center flex-wrap">
                <button type="button" class="btn srh-btn-outline" (click)="limpiar()">
                  Limpiar
                </button>
              </div>

            </div>

            <div class="card-body">
              <form [formGroup]="form" (ngSubmit)="guardar()" class="d-grid gap-3">

                <div>
                  <label class="form-label fw-bold">N√∫mero</label>
                  <input class="form-control srh-input" placeholder="Ej: 101" formControlName="numero" />
                </div>

                <div>
                  <label class="form-label fw-bold">Tipo</label>
                  <input class="form-control srh-input" placeholder="Ej: Suite" formControlName="tipo" />
                </div>

                <div>
                  <label class="form-label fw-bold">Precio</label>
                  <div class="input-group">
                    <span class="input-group-text">$</span>
                    <input type="number" class="form-control srh-input" placeholder="Ej: 45" formControlName="precio" />
                  </div>
                </div>

                <div class="form-check">
                  <input type="checkbox" class="form-check-input" id="disp" formControlName="disponible" />
                  <label class="form-check-label fw-bold" for="disp">
                    Disponible
                  </label>
                </div>

                <button class="btn srh-btn-primary w-100" type="submit" [disabled]="form.invalid || saving">
                  {{ editandoId !== null ? 'Actualizar' : 'Guardar' }}
                </button>

              </form>
            </div>
          </div>
        </div>

        <!-- LISTADO -->
        <div class="col-12 col-lg-8">
          <div class="card srh-card shadow-lg">

            <div class="card-header srh-head d-flex align-items-center justify-content-between">

              <div class="d-flex align-items-center gap-2">
                <span class="srh-ico">üìã</span>
                <strong>Listado</strong>
              </div>

              <div class="d-flex align-items-center gap-2 flex-wrap ms-auto">

                <div class="input-group" style="max-width:300px;">
                  <span class="input-group-text">
                    <i class="bi bi-search"></i>
                  </span>
                  <input
                    #search
                    type="text"
                    class="form-control"
                    placeholder="Buscar por n√∫mero, tipo..."
                    (input)="onBuscar(search.value)"
                  />
                </div>

                <button type="button" class="btn srh-btn-reload" (click)="cargar()">
                  Recargar
                </button>

              </div>
            </div>

            <div class="card-body p-0">

              <div *ngIf="loading" class="text-center py-4">
                <div class="spinner-border text-primary"></div>
                <div class="mt-2">Cargando habitaciones...</div>
              </div>

              <div *ngIf="!loading" class="table-responsive">

                <table class="table srh-table mb-0">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>N√∫mero</th>
                      <th>Tipo</th>
                      <th>Precio</th>
                      <th>Disponible</th>
                      <th style="width:220px" class="text-center">Acciones</th>
                    </tr>
                  </thead>

                  <tbody>

                    <tr *ngFor="let h of habitacionesFiltradas; trackBy: trackById">
                      <td class="fw-bold">{{ h.id }}</td>
                      <td>{{ h.numero }}</td>
                      <td>{{ h.tipo }}</td>
                      <td>$ {{ h.precio }}</td>

                      <td>
                        <span class="badge" [ngClass]="h.disponible ? 'bg-success' : 'bg-secondary'">
                          {{ h.disponible ? 'Disponible' : 'Ocupada' }}
                        </span>
                      </td>

                      <td class="text-center">
                        <div class="btn-group btn-group-sm flex-wrap">

                          <!-- EDITAR -->
                          <button class="srh-btn-action" (click)="editar(h)">
                            Editar
                          </button>

                          <!-- ELIMINAR -->
                          <button class="srh-btn-action" (click)="eliminar(h)" [disabled]="deletingId === h.id">
                            {{ deletingId === h.id ? 'Eliminando...' : 'Eliminar' }}
                          </button>

                        </div>
                      </td>
                    </tr>

                    <tr *ngIf="habitacionesFiltradas.length === 0">
                      <td colspan="6" class="text-center py-4 text-muted">
                        No hay habitaciones registradas.
                      </td>
                    </tr>

                  </tbody>
                </table>

              </div>

            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>